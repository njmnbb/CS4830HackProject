<!DOCTYPE HTML>
<html>
<head>
	<title>Socket Simon</title>
	<link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
	<img src = "images/logo.png" class = "logo">
	<div class = "header">
		<p class = "header-text">Select your role:</p>
	</div>

	<!-- Game Frame -->
	<div id="game">

		<div class = "player">
			<img src="images/player.jpg">
			<p class = "role-description">I am the player. I play things that are given to me.</p>
			<button id="player" onclick="startGame(this.id)">Start</button>
		</div>
		<div class = "simon">
			<img src="images/simon.jpg">
			<p class = "role-description">I am Simon, hear me roar. I am to be feared and nothing else.</p>
			<button id="simon" onclick="startGame(this.id)">Start</button>
		</div>

	<!-- End Game Frame -->
	</div>

	<!-- Scripts at bottom for faster page loading -->
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script src="https://cdn.socket.io/socket.io-1.2.0.js">
		var socket = io();
		var role;
		//var simonArr = [];
		//var round = 1;

		// Function for 'start' buttons
	 	function startGame(sentRole) {
	    	//alert('You started the game as a ' + sentRole);
	    	role = sentRole;

	    	// Clear Header and game frame
	    	clearDiv('simon');
	    	clearDiv('player');
	    	clearDiv('header');

	    	// populate with gameData
	    	loadGameAs(role, 'player', 'simon', 'header');
	    	while(1) {
	    		playRound();
	    	}
	 	}

	 	// Function to get current role of player.
	 	function currentRole() {
	 		if( role != undefined )
	 			// console.log(role);
	 			return role;
	 	}

	 	// Clear a Div
	 	function clearDiv(elementID) {
	    	document.getElementsByClassName(elementID)[0].innerHTML = "";
		}

		// Game functions
		function loadGameAs(role, leftDiv, rightDiv, headerDiv) {
			if( role == 'player') {
				document.getElementsByClassName(headerDiv)[0].innerHTML = '<p class = "header-text">Waiting for Simon...</p>';
				document.getElementsByClassName(leftDiv)[0].innerHTML = '<p class = "header-text">You</p><input type = "image" value = "0" class = "quadrant-active" src = "images/simon/green.png"></input><input type = "image" value = "1" class = "quadrant-active" src = "images/simon/red.png"></input><input type = "image" value = "2" class = "quadrant-active" src = "images/simon/yellow.png"></input><input type = "image" value = "3" class = "quadrant-active" src = "images/simon/blue.png"></input>';
				document.getElementsByClassName(rightDiv)[0].innerHTML = '<p class = "header-text">Simon</p><img src="images/simon/green.png" class = "quadrant"><img src="images/simon/red.png" class = "quadrant"><img src="images/simon/yellow.png" class = "quadrant"><img src="images/simon/blue.png" class = "quadrant">';
			}
			else if( role == 'simon' ) {
				socket.on('simon message', function(msg){
					console.log("Role 'Simon'. Message recieved");
				});
				document.getElementsByClassName(headerDiv)[0].innerHTML = '<p class = "header-text">Create a pattern...</p>';
				document.getElementsByClassName(leftDiv)[0].innerHTML = '<p class = "header-text">You</p><input type = "image" value = "0" class = "quadrant-active" src = "images/simon/green.png"></input><input type = "image" value = "1" class = "quadrant-active" src = "images/simon/red.png"></input><input type = "image" value = "2" class = "quadrant-active" src = "images/simon/yellow.png"></input><input type = "image" value = "3" class = "quadrant-active" src = "images/simon/blue.png"></input><button>Send</button>';
				document.getElementsByClassName(rightDiv)[0].innerHTML = '<p class = "header-text">Player</p><img src="images/simon/green.png" class = "quadrant"><img src="images/simon/red.png" class = "quadrant"><img src="images/simon/yellow.png" class = "quadrant"><img src="images/simon/blue.png" class = "quadrant">';
			}
			else {
				// No
			}
		}

		function playRound() {
			// Appends the id of the clicked quadrant to
			// an array. Array can only be as long as the current
			// round (i.e. on round 3, array can only have 3 values)
			$(document).on("click", ".quadrant-active", function() {
				if(simonArr.length >= round) {
					return 0;
				}
				else {
					simonArr.push($(this).attr('value'));
					console.log(simonArr);
					console.log(round);
					//socket.emit('simon message', "hello");
				}
			});
		}
	</script>
</body>
</html>